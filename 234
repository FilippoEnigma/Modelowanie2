module PetriNetTransformation;

create OUT : TARGET from IN : SOURCE;

rule Model2Model {
    from
        src : SOURCE!Model
    to
        tgt : TARGET!Model (
            name <- src.name,
            place <- src.place,
            transition <- src.transition,
            arcp2t <- src.arc->select(a | a.P2T),
            arct2p <- src.arc->select(a | a.T2P)
        )
}

rule Place2Place {
    from
        src : SOURCE!Place
    to
        tgt : TARGET!Place (
            name <- src.name,
            tokens <- src.tokens
        )
}

rule Transition2Transition {
    from
        src : SOURCE!Transition
    to
        tgt : TARGET!Transition (
            name <- src.name
        )
}

rule Arc2ArcP2T {
    from
        src : SOURCE!Arc (src.P2T = true)
    to
        tgt : TARGET!ArcP2T (
            name <- src.name,
            weight <- src.weight,
            inhibitor <- src.inhibitor,
            place <- src.source,
            transition <- src.target
        )
}

rule Arc2ArcT2P {
    from
        src : SOURCE!Arc (src.T2P = true)
    to
        tgt : TARGET!ArcT2P (
            name <- src.name,
            weight <- src.weight,
            place <- src.target,
            transition <- src.source
        )
}
